USE `solusi-umkm`;

create table KATEGORI_UMKM(
	ID_KATEGORI_UMKM int auto_increment primary key,
	KATEGORI_UMKM varchar(45) not null
);

create table UMKM(
	ID_UMKM int primary key not null auto_increment,
	NAMA_UMKM varchar(45) not null,
	PEMILIK_UMKM varchar(45) not null,
	ID_KATEGORI_UMKM INT NOT NULL,
	DETAIL_PRODUK_UMKM VARCHAR(45) NOT NULL,
	VISI TEXT,
	MISI TEXT,
	ALAMAT TEXT,
	NO_TELP VARCHAR(25),
	EMAIL varchar(45),
	foreign key (ID_KATEGORI_UMKM) REFERENCES KATEGORI_UMKM(ID_KATEGORI_UMKM)
);

create table PRODUK(
	ID_PRODUK int auto_increment primary key,
	ID_UMKM INT NOT NULL,
	KODE_PRODUK varchar(45) not null unique,
	NAMA_PRODUK varchar(45) not null,
	HARGA decimal(11,2),
	DESKRIPSI text not null,
	FOREIGN KEY(ID_UMKM) REFERENCES UMKM(ID_UMKM)
);

CREATE TABLE FOTO(
	ID_FOTO INT NOT NULL PRIMARY KEY,
	NAMA_FILE TEXT NOT NULL,
	KETERANGAN TEXT
);

CREATE TABLE DISTRIBUSI_FOTO(
	ID_DISTRIBUSI INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
	ID_PRODUK INT NOT NULL,
	ID_FOTO INT NOT NULL,
	FOREIGN KEY(ID_PRODUK) REFERENCES PRODUK(ID_PRODUK),
	FOREIGN KEY(ID_FOTO) REFERENCES FOTO(ID_FOTO)
);

create table PERMASALAHAN(
	ID_PERMASALAHAN INT NOT NULL PRIMARY KEY,
	PERMASALAHAN TEXT NOT NULL
);

CREATE TABLE DETAIL_PERMASALAHAN(
	ID_DETAIL_PERMASALAHAN INT NOT NULL PRIMARY KEY,
	ID_PERMASALAHAN INT NOT NULL,
	FOREIGN KEY(ID_PERMASALAHAN) REFERENCES PERMASALAHAN(ID_PERMASALAHAN)
);

CREATE TABLE SOLUSI_PERMASALAHAN(
	ID_SOLUSI INT NOT NULL PRIMARY KEY,
	ID_DETAIL_PERMASALAHAN INT NOT NULL,
	FOREIGN KEY(ID_DETAIL_PERMASALAHAN) REFERENCES DETAIL_PERMASALAHAN(ID_DETAIL_PERMASALAHAN)
);

CREATE TABLE PERMASALAHAN_UMKM(
	ID_PERMASALAHAN_UMKM INT NOT NULL PRIMARY KEY,
	ID_UMKM INT NOT NULL,
	ID_PERMASALAHAN INT NOT NULL,
	FOREIGN KEY(ID_UMKM) REFERENCES UMKM(ID_UMKM),
	FOREIGN KEY(ID_PERMASALAHAN) REFERENCES PERMASALAHAN(ID_PERMASALAHAN)
);